---
title: 开始将 Docker 容器与适用于 Linux 的 Windows 子系统配合使用
description: 了解如何在适用于 Linux 的 Windows 子系统上设置 Docker 容器。
keywords: wsl、windows、windowssubsystem、windows 10、docker、容器
ms.date: 08/28/2020
ms.topic: article
ms.localizationpriority: medium
ms.openlocfilehash: a972cd6f179059e0841e1aef4bc3929fa46fcc4d
ms.sourcegitcommit: 1c7f2e9928672ad3941a9327162595cb73ef5a3f
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/09/2020
ms.locfileid: "89609641"
---
# <a name="get-started-with-docker-remote-containers-on-wsl-2"></a><span data-ttu-id="cb10c-104">WSL 2 上的 Docker 远程容器入门</span><span class="sxs-lookup"><span data-stu-id="cb10c-104">Get started with Docker remote containers on WSL 2</span></span>

<span data-ttu-id="cb10c-105">此循序渐进指南将帮助你开始使用远程容器进行开发，方法是 **使用 WSL 2** (适用于 Linux 的 windows 子系统，版本 2) 来设置用于 Windows 的 Docker 桌面。</span><span class="sxs-lookup"><span data-stu-id="cb10c-105">This step-by-step guide will help you get started developing with remote containers by **setting up Docker Desktop for Windows with WSL 2** (Windows Subsystem for Linux, version 2).</span></span>

<span data-ttu-id="cb10c-106">适用于 Windows 的 Docker Desktop 免费提供，并提供用于生成、传送和运行 dockerized 应用的开发环境。</span><span class="sxs-lookup"><span data-stu-id="cb10c-106">Docker Desktop for Windows is available for free and provides a development environment for building, shipping, and running dockerized apps.</span></span> <span data-ttu-id="cb10c-107">通过启用基于 WSL 2 的引擎，你可以在同一台计算机上的 Docker Desktop 中同时运行 Linux 和 Windows 容器。</span><span class="sxs-lookup"><span data-stu-id="cb10c-107">By enabling the WSL 2 based engine, you can run both Linux and Windows containers in Docker Desktop on the same machine.</span></span>

## <a name="overview-of-docker-containers"></a><span data-ttu-id="cb10c-108">Docker 容器概述</span><span class="sxs-lookup"><span data-stu-id="cb10c-108">Overview of Docker containers</span></span>

<span data-ttu-id="cb10c-109">Docker 是一种工具，用于创建、部署和运行应用程序（通过使用容器）。</span><span class="sxs-lookup"><span data-stu-id="cb10c-109">Docker is a tool used to create, deploy, and run applications using containers.</span></span> <span data-ttu-id="cb10c-110">容器使开发人员可以将应用与需要的所有部件（库、框架、依赖项等）打包为一个包一起交付。</span><span class="sxs-lookup"><span data-stu-id="cb10c-110">Containers enable developers to package an app with all of the parts it needs (libraries, frameworks, dependencies, etc) and ship it all out as one package.</span></span> <span data-ttu-id="cb10c-111">使用容器可确保此应用的运行与之前相同，而不受任何自定义设置或运行该应用的计算机上先前安装的库的影响（运行应用的计算机可能与用于编写和测试应用代码的计算机不同）。</span><span class="sxs-lookup"><span data-stu-id="cb10c-111">Using a container ensures that the app will run the same regardless of any customized settings or previously installed libraries on the computer running it that could differ from the machine that was used to write and test the app's code.</span></span> <span data-ttu-id="cb10c-112">这使开发人员可以专注于编写代码，而无需操心将运行代码的系统。</span><span class="sxs-lookup"><span data-stu-id="cb10c-112">This permits developers to focus on writing code without worrying about the system that code will be run on.</span></span>

<span data-ttu-id="cb10c-113">Docker 容器与虚拟机类似，但不会创建整个虚拟操作系统。</span><span class="sxs-lookup"><span data-stu-id="cb10c-113">Docker containers are similar to virtual machines, but don't create an entire virtual operating system.</span></span> <span data-ttu-id="cb10c-114">相反，Docker 允许应用使用与运行它的系统相同的 Linux 内核。</span><span class="sxs-lookup"><span data-stu-id="cb10c-114">Instead, Docker enables the app to use the same Linux kernel as the system that it's running on.</span></span> <span data-ttu-id="cb10c-115">这使得应用包能够仅要求主计算机上尚未安装的部件，从而降低包大小以及提高性能。</span><span class="sxs-lookup"><span data-stu-id="cb10c-115">This allows the app package to only require parts not already on the host computer, reducing the package size and improving performance.</span></span>

<span data-ttu-id="cb10c-116">将 Docker 容器与 [Kubernetes](https://docs.microsoft.com/azure/aks/) 等工具结合使用以实现持续可用性是容器普及的另一个原因。</span><span class="sxs-lookup"><span data-stu-id="cb10c-116">Continuous availability, using Docker containers with tools like [Kubernetes](https://docs.microsoft.com/azure/aks/), is another reason for the popularity of containers.</span></span> <span data-ttu-id="cb10c-117">这样就可以在不同的时间创建应用容器的多个版本。</span><span class="sxs-lookup"><span data-stu-id="cb10c-117">This enables multiple versions of your app container to be created at different times.</span></span> <span data-ttu-id="cb10c-118">并且每个容器（及其特定的微服务）均可以动态更换，而无需停止整个系统进行更新或维护。</span><span class="sxs-lookup"><span data-stu-id="cb10c-118">Rather than needing to take down an entire system for updates or maintenance, each container (and it's specific microservices) can be replaced on the fly.</span></span> <span data-ttu-id="cb10c-119">你可以准备一个包含所有更新的新容器，将该容器设置用于生产，并在新容器准备就绪后直接指向该容器。</span><span class="sxs-lookup"><span data-stu-id="cb10c-119">You can prepare a new container with all of your updates, set up the container for production, and just point to the new container once it's ready.</span></span> <span data-ttu-id="cb10c-120">你还可以使用容器对不同版本的应用进行存档，如有需要，还可将其作为安全回退保持运行。</span><span class="sxs-lookup"><span data-stu-id="cb10c-120">You can also archive different versions of your app using containers and keep them running as a safety fallback if needed.</span></span>

<span data-ttu-id="cb10c-121">若要了解详细信息，请查看 Microsoft Learn 上的 [Docker 容器简介](https://docs.microsoft.com/learn/modules/intro-to-docker-containers/) 。</span><span class="sxs-lookup"><span data-stu-id="cb10c-121">To learn more, checkout the [Introduction to Docker containers](https://docs.microsoft.com/learn/modules/intro-to-docker-containers/) on Microsoft Learn.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="cb10c-122">先决条件</span><span class="sxs-lookup"><span data-stu-id="cb10c-122">Prerequisites</span></span>

- <span data-ttu-id="cb10c-123">确保你的计算机运行的是 Windows 10， [并已更新到版本2004、版本](ms-settings:windowsupdate) **18362** 或更高版本。</span><span class="sxs-lookup"><span data-stu-id="cb10c-123">Ensure your machine is running Windows 10, [updated to version 2004](ms-settings:windowsupdate), **Build 18362** or higher.</span></span>
- <span data-ttu-id="cb10c-124">[启用 WSL、安装 Linux 分发版和更新到 WSL 2](https://docs.microsoft.com/windows/wsl/install-win10)。</span><span class="sxs-lookup"><span data-stu-id="cb10c-124">[Enable WSL, install a Linux distribution, and update to WSL 2](https://docs.microsoft.com/windows/wsl/install-win10).</span></span>
- <span data-ttu-id="cb10c-125">[下载并安装 Linux 内核更新包](https://docs.microsoft.com/windows/wsl/wsl2-kernel)。</span><span class="sxs-lookup"><span data-stu-id="cb10c-125">[Download and install the Linux kernel update package](https://docs.microsoft.com/windows/wsl/wsl2-kernel).</span></span>
- <span data-ttu-id="cb10c-126">[安装](https://code.visualstudio.com/download) \* (可选) \*Visual Studio Code。</span><span class="sxs-lookup"><span data-stu-id="cb10c-126">[Install Visual Studio Code](https://code.visualstudio.com/download) *(optional)*.</span></span> <span data-ttu-id="cb10c-127">这将提供最佳体验，包括在远程 Docker 容器内进行代码和调试并连接到 Linux 分发的功能。</span><span class="sxs-lookup"><span data-stu-id="cb10c-127">This will provide the best experience, including the ability to code and debug inside a remote Docker container and connected to your Linux distribution.</span></span>
- <span data-ttu-id="cb10c-128">[安装 Windows 终端](https://docs.microsoft.com/windows/terminal/get-started) \* (可选) \*。</span><span class="sxs-lookup"><span data-stu-id="cb10c-128">[Install Windows Terminal](https://docs.microsoft.com/windows/terminal/get-started) *(optional)*.</span></span> <span data-ttu-id="cb10c-129">这会提供最佳体验，包括在同一接口中自定义和打开多个终端 (包括 Ubuntu、Debian、PowerShell、Azure CLI 或你喜欢) 的任何内容。</span><span class="sxs-lookup"><span data-stu-id="cb10c-129">This will provide the best experience, including the ability to customize and open multiple terminals in the same interface (including Ubuntu, Debian, PowerShell, Azure CLI, or whatever you prefer to use).</span></span>
- <span data-ttu-id="cb10c-130">[在 Docker Hub 上注册 DOCKER ID](https://hub.docker.com/signup) \* (可选) \*。</span><span class="sxs-lookup"><span data-stu-id="cb10c-130">[Sign up for a Docker ID at Docker Hub](https://hub.docker.com/signup) *(optional)*.</span></span>

> [!NOTE]
> <span data-ttu-id="cb10c-131">WSL 可以在 WSL 版本1或 WSL 2 模式下运行分发。</span><span class="sxs-lookup"><span data-stu-id="cb10c-131">WSL can run distributions in both WSL version 1 or WSL 2 mode.</span></span> <span data-ttu-id="cb10c-132">可以通过打开 PowerShell 并输入以下内容来进行检查： `wsl -l -v` 。</span><span class="sxs-lookup"><span data-stu-id="cb10c-132">You can check this by opening PowerShell and entering: `wsl -l -v`.</span></span> <span data-ttu-id="cb10c-133">输入以下内容，确保将分发设置为使用 WSL 2： `wsl --set-version  <distro> 2` 。</span><span class="sxs-lookup"><span data-stu-id="cb10c-133">Ensure that the your distribution is set to use WSL 2 by entering: `wsl --set-version  <distro> 2`.</span></span> <span data-ttu-id="cb10c-134">`<distro>`用发行版名称替换 (例如 Ubuntu 18.04) 。</span><span class="sxs-lookup"><span data-stu-id="cb10c-134">Replace `<distro>` with the distro name (e.g. Ubuntu 18.04).</span></span>
> 
> <span data-ttu-id="cb10c-135">在 WSL 版本1中，由于 Windows 和 Linux 之间的基本差异，Docker 引擎无法直接在 WSL 内运行，因此 Docker 团队开发了使用 Hyper-v Vm 和 LinuxKit 的替代解决方案。</span><span class="sxs-lookup"><span data-stu-id="cb10c-135">In WSL version 1, due to fundamental differences between Windows and Linux, the Docker Engine couldn't run directly inside WSL, so the Docker team developed an alternative solution using Hyper-V VMs and LinuxKit.</span></span> <span data-ttu-id="cb10c-136">但是，因为 WSL 2 现在运行在具有完全系统调用容量的 Linux 内核上，所以 Docker 可以在 WSL 2 中完全运行。</span><span class="sxs-lookup"><span data-stu-id="cb10c-136">However, since WSL 2 now runs on a Linux kernel with full system call capacity, Docker can fully run in WSL 2.</span></span> <span data-ttu-id="cb10c-137">这意味着 Linux 容器可以在无需模拟的情况下运行，从而在 Windows 和 Linux 工具之间实现更好的性能和互操作性。</span><span class="sxs-lookup"><span data-stu-id="cb10c-137">This means that Linux containers can run natively without emulation, resulting in better performance and interoperability between your Windows and Linux tools.</span></span>

## <a name="install-docker-desktop"></a><span data-ttu-id="cb10c-138">安装 Docker Desktop</span><span class="sxs-lookup"><span data-stu-id="cb10c-138">Install Docker Desktop</span></span>

<span data-ttu-id="cb10c-139">对于 Windows 的 Docker Desktop 中支持 WSL 2 后端，你可以在基于 Linux 的开发环境中工作，并构建基于 Linux 的容器，同时使用 Visual Studio Code 进行代码编辑和调试，以及在 Windows 上的 Microsoft Edge 浏览器中运行容器。</span><span class="sxs-lookup"><span data-stu-id="cb10c-139">With the WSL 2 backend supported in Docker Desktop for Windows, you can work in a Linux-based development environment and build Linux-based containers, while using Visual Studio Code for code editing and debugging, and running your container in the Microsoft Edge browser on Windows.</span></span>

<span data-ttu-id="cb10c-140">若要在已 [安装 WSL 2](https://docs.microsoft.com/windows/wsl/install-win10)) 之后安装 Docker (：</span><span class="sxs-lookup"><span data-stu-id="cb10c-140">To install Docker (after already [installing WSL 2](https://docs.microsoft.com/windows/wsl/install-win10)):</span></span>

1. <span data-ttu-id="cb10c-141">下载 [Docker Desktop](https://docs.docker.com/docker-for-windows/wsl/#download) 并按照安装说明进行操作。</span><span class="sxs-lookup"><span data-stu-id="cb10c-141">Download [Docker Desktop](https://docs.docker.com/docker-for-windows/wsl/#download) and follow the installation instructions.</span></span>

2. <span data-ttu-id="cb10c-142">安装完成后，从 Windows "开始" 菜单启动 Docker Desktop，并从任务栏的 "隐藏的图标" 菜单中选择 "Docker" 图标。</span><span class="sxs-lookup"><span data-stu-id="cb10c-142">Once installed, start Docker Desktop from the Windows Start menu, then select the Docker icon from the hidden icons menu of your taskbar.</span></span> <span data-ttu-id="cb10c-143">右键单击该图标可显示 Docker 命令菜单，并选择 "设置"。</span><span class="sxs-lookup"><span data-stu-id="cb10c-143">Right-click the icon to display the Docker commands menu and select "Settings".</span></span>
    <span data-ttu-id="cb10c-144">![Docker 桌面面板图标](../media/docker-starting.png)</span><span class="sxs-lookup"><span data-stu-id="cb10c-144">![Docker Desktop dashboard icon](../media/docker-starting.png)</span></span>

3. <span data-ttu-id="cb10c-145">确保在 "**设置**" "常规" 中选中 "使用基于 WSL 2 的引擎"  >  **General**。</span><span class="sxs-lookup"><span data-stu-id="cb10c-145">Ensure that "Use the WSL 2 based engine" is checked in **Settings** > **General**.</span></span>
    <span data-ttu-id="cb10c-146">![Docker 桌面常规设置](../media/docker-running.png)</span><span class="sxs-lookup"><span data-stu-id="cb10c-146">![Docker Desktop general settings](../media/docker-running.png)</span></span>

4. <span data-ttu-id="cb10c-147">转到 "**设置**  >  **资源**  >  **WSL 集成**"，从已安装的 WSL 2 分发中选择要启用 Docker 集成。</span><span class="sxs-lookup"><span data-stu-id="cb10c-147">Select from your installed WSL 2 distributions which you want to enable Docker integration on by going to: **Settings** > **Resources** > **WSL Integration**.</span></span>
    <span data-ttu-id="cb10c-148">![Docker 桌面资源设置](../media/docker-dashboard.png)</span><span class="sxs-lookup"><span data-stu-id="cb10c-148">![Docker Desktop resource settings](../media/docker-dashboard.png)</span></span>

5. <span data-ttu-id="cb10c-149">若要确认是否已安装 Docker，请打开 WSL 分发 (例如 Ubuntu) 并通过输入以下内容来显示版本和版本号： `docker --version`</span><span class="sxs-lookup"><span data-stu-id="cb10c-149">To confirm that Docker has been installed, open a WSL distribution (e.g. Ubuntu) and display the version and build number by entering: `docker --version`</span></span>

6. <span data-ttu-id="cb10c-150">使用以下方法运行简单的内置 Docker 映像，测试安装是否正常： `docker run hello-world`</span><span class="sxs-lookup"><span data-stu-id="cb10c-150">Test that your installation works correctly by running a simple built-in Docker image using: `docker run hello-world`</span></span>

> [!TIP]
> <span data-ttu-id="cb10c-151">下面是一些有用的 Docker 命令，可了解：</span><span class="sxs-lookup"><span data-stu-id="cb10c-151">Here are a few helpful Docker commands to know:</span></span>
>
> - <span data-ttu-id="cb10c-152">通过输入以下命令列出 Docker CLI 中可用的命令：`docker`</span><span class="sxs-lookup"><span data-stu-id="cb10c-152">List the commands available in the Docker CLI by entering: `docker`</span></span>
> - <span data-ttu-id="cb10c-153">使用以下命令列出特定命令的信息：`docker <COMMAND> --help`</span><span class="sxs-lookup"><span data-stu-id="cb10c-153">List information for a specific command with: `docker <COMMAND> --help`</span></span>
> - <span data-ttu-id="cb10c-154">使用以下命令列出计算机上的 docker 映像（此时仅为 hello-world 映像）：`docker image ls --all`</span><span class="sxs-lookup"><span data-stu-id="cb10c-154">List the docker images on your machine (which is just the hello-world image at this point), with: `docker image ls --all`</span></span>
> - <span data-ttu-id="cb10c-155">列出计算机上的容器，使用： `docker container ls --all` 或 `docker ps -a` (不包含-a show all 标志，只显示运行的容器) </span><span class="sxs-lookup"><span data-stu-id="cb10c-155">List the containers on your machine, with: `docker container ls --all` or `docker ps -a` (without the -a show all flag, only running containers will be displayed)</span></span>
> - <span data-ttu-id="cb10c-156">列出有关 Docker 安装的系统范围内的信息，包括 WSL 2 上下文中可用的统计信息和资源 (CPU & 内存) ，使用： `docker info`</span><span class="sxs-lookup"><span data-stu-id="cb10c-156">List system-wide information regarding the Docker installation, including statistics and resources (CPU & memory) available to you in the WSL 2 context, with: `docker info`</span></span>

## <a name="develop-in-remote-containers-using-vs-code"></a><span data-ttu-id="cb10c-157">使用 VS Code 在远程容器中进行开发</span><span class="sxs-lookup"><span data-stu-id="cb10c-157">Develop in remote containers using VS Code</span></span>

<span data-ttu-id="cb10c-158">若要开始使用 Docker 和 WSL 2 来开发应用，我们建议使用 VS Code，以及 WSL 扩展和 Docker 扩展。</span><span class="sxs-lookup"><span data-stu-id="cb10c-158">To get started developing apps using Docker with WSL 2, we recommend using VS Code, along with the Remote-WSL extension and Docker extension.</span></span>

- <span data-ttu-id="cb10c-159">[安装 VS Code 远程 WSL 扩展](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-wsl)。</span><span class="sxs-lookup"><span data-stu-id="cb10c-159">[Install the VS Code Remote-WSL extension](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-wsl).</span></span> <span data-ttu-id="cb10c-160">此扩展使你能够在 VS Code 中打开在 WSL 上运行的 Linux 项目， (无需担心路径问题、二进制兼容性或) 的其他跨操作系统挑战。</span><span class="sxs-lookup"><span data-stu-id="cb10c-160">This extension enables you to open your Linux project running on WSL in VS Code (no need to worry about pathing issues, binary compatibility, or other cross-OS challenges).</span></span>

- <span data-ttu-id="cb10c-161">[安装 VS Code 远程容器扩展](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers)。</span><span class="sxs-lookup"><span data-stu-id="cb10c-161">[Install the VS code Remote-Containers extension](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers).</span></span> <span data-ttu-id="cb10c-162">此扩展使你能够在容器中打开你的项目文件夹或存储库，利用 Visual Studio Code 的完整功能集来完成容器中的开发工作。</span><span class="sxs-lookup"><span data-stu-id="cb10c-162">This extension enables you to open your project folder or repo inside of a container, taking advantage of Visual Studio Code's full feature set to do your development work within the container.</span></span>

- <span data-ttu-id="cb10c-163">[安装 VS Code Docker 扩展](https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker)。</span><span class="sxs-lookup"><span data-stu-id="cb10c-163">[Install the VS Code Docker extension](https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker).</span></span> <span data-ttu-id="cb10c-164">此扩展添加了从 VS Code 内部生成、管理和部署容器化应用程序的功能。</span><span class="sxs-lookup"><span data-stu-id="cb10c-164">This extension adds the functionality to build, manage, and deploy containerized applications from  inside VS Code.</span></span> <span data-ttu-id="cb10c-165"> (需要远程容器扩展，才能实际使用容器作为开发环境。 ) </span><span class="sxs-lookup"><span data-stu-id="cb10c-165">(You need the Remote-Container extension to actually use the container as your dev environment.)</span></span>

<span data-ttu-id="cb10c-166">让我们使用 Docker 为现有应用程序项目创建一个开发容器。</span><span class="sxs-lookup"><span data-stu-id="cb10c-166">Let's use Docker to create a development container for an existing app project.</span></span>

1. <span data-ttu-id="cb10c-167">在此示例中，我将使用 my [Hello World 教程](https://docs.microsoft.com/windows/python/web-frameworks#hello-world-tutorial-for-django) 中的源代码，以便在 Python 开发环境中安装文档。如果希望使用自己的项目源代码，则可以跳过此步骤。</span><span class="sxs-lookup"><span data-stu-id="cb10c-167">For this example, I'll use the source code from my [Hello World tutorial for Django](https://docs.microsoft.com/windows/python/web-frameworks#hello-world-tutorial-for-django) in the Python development environment set up docs. You can skip this step if you prefer to use your own project source code.</span></span> <span data-ttu-id="cb10c-168">若要从 GitHub 下载 HelloWorld Django web 应用，请打开 WSL terminal (Ubuntu，例如) 并输入： `git clone https://github.com/mattwojo/helloworld-django.git`</span><span class="sxs-lookup"><span data-stu-id="cb10c-168">To download my HelloWorld-Django web app from GitHub, open a WSL terminal (Ubuntu for example) and enter: `git clone https://github.com/mattwojo/helloworld-django.git`</span></span>

    > [!NOTE]
    > <span data-ttu-id="cb10c-169">始终将代码存储在使用工具的同一文件系统中。</span><span class="sxs-lookup"><span data-stu-id="cb10c-169">Always store your code in the same file system that you're using tools in.</span></span> <span data-ttu-id="cb10c-170">这将提高文件访问性能。</span><span class="sxs-lookup"><span data-stu-id="cb10c-170">This will result in faster file access performance.</span></span> <span data-ttu-id="cb10c-171">在此示例中，我们使用的是 Linux 发行版 (Ubuntu) 并想要将项目文件存储在 WSL 文件系统上 `\\wsl\` 。</span><span class="sxs-lookup"><span data-stu-id="cb10c-171">In this example, we are using a Linux distro (Ubuntu) and want to store our project files on the WSL file system `\\wsl\`.</span></span> <span data-ttu-id="cb10c-172">使用 WSL 中的 Linux 工具访问这些文件时，在 Windows 文件系统上存储项目文件会显著降低性能。</span><span class="sxs-lookup"><span data-stu-id="cb10c-172">Storing project files on the Windows file system would significantly slow things down when using Linux tools in WSL to access those files.</span></span>

2. <span data-ttu-id="cb10c-173">在 WSL 终端中，将目录更改为此项目的源代码文件夹：</span><span class="sxs-lookup"><span data-stu-id="cb10c-173">From your WSL terminal, change directories to the source code folder for this project:</span></span>

    ```bash
    cd helloworld-django
    ```

3. <span data-ttu-id="cb10c-174">通过输入以下内容在本地 WSL 扩展服务器上运行的 VS Code 中打开项目：</span><span class="sxs-lookup"><span data-stu-id="cb10c-174">Open the project in VS Code running on the local Remote-WSL extension server by entering:</span></span>

    ```bash
    code .
    ```

    <span data-ttu-id="cb10c-175">通过检查 VS Code 实例左下角的绿色远程指示器，确认已连接到 WSL Linux 发行版。</span><span class="sxs-lookup"><span data-stu-id="cb10c-175">Confirm that you are connected to your WSL Linux distro by checking the green remote indicator in the bottom-left corner of your VS Code instance.</span></span>

    ![VS Code WSL 远程指示器](../media/vscode-remote-indicator.png)

4. <span data-ttu-id="cb10c-177">从 VS Code 命令调色板 ("Ctrl + Shift + P) ，输入： **远程容器：在容器中打开文件夹 ...** 如果在开始键入此命令时未显示此命令，请检查以确保已安装上面链接的远程容器扩展。</span><span class="sxs-lookup"><span data-stu-id="cb10c-177">From the VS Code command pallette (Ctrl + Shift + P), enter: **Remote-Containers: Open Folder in Container...** If this command doesn't display as you begin to type it, check to ensure that you've installed the Remote Container extension linked above.</span></span>

    ![VS Code 远程容器命令](../media/docker-extension.png)

5. <span data-ttu-id="cb10c-179">选择要容器化的项目文件夹。</span><span class="sxs-lookup"><span data-stu-id="cb10c-179">Select the project folder that you wish to containerize.</span></span> <span data-ttu-id="cb10c-180">在我的示例中，这是 `\\wsl\Ubuntu-20.04\home\mattwojo\repos\helloworld-django\`</span><span class="sxs-lookup"><span data-stu-id="cb10c-180">In my case, this is `\\wsl\Ubuntu-20.04\home\mattwojo\repos\helloworld-django\`</span></span>

    ![VS Code 远程容器文件夹](../media/docker-extension2.png)

6. <span data-ttu-id="cb10c-182">将显示容器定义的列表，因为项目文件夹中没有 DevContainer 配置 (存储库) 。</span><span class="sxs-lookup"><span data-stu-id="cb10c-182">A list of container definitions will appear, since there is no DevContainer configuration in the project folder (repo) yet.</span></span> <span data-ttu-id="cb10c-183">根据项目类型筛选显示的容器配置定义的列表。</span><span class="sxs-lookup"><span data-stu-id="cb10c-183">The list of container configuration definitions that appears is filtered based on your project type.</span></span> <span data-ttu-id="cb10c-184">对于我的 Django 项目，请选择 "Python 3"。</span><span class="sxs-lookup"><span data-stu-id="cb10c-184">For my Django project, I'll select Python 3.</span></span>

    ![VS Code 远程容器配置定义](../media/docker-extension3.png)

7. <span data-ttu-id="cb10c-186">将打开 VS Code 的新实例，开始生成新映像，完成生成后，将启动容器。</span><span class="sxs-lookup"><span data-stu-id="cb10c-186">A new instance of VS Code will open, begin building our new image, and once the build completed, will start our container.</span></span> <span data-ttu-id="cb10c-187">你会看到，在 `.devcontainer` 和文件中有一个包含容器配置信息的新文件夹 `Dockerfile` `devcontainer.json` 。</span><span class="sxs-lookup"><span data-stu-id="cb10c-187">You will see that a new `.devcontainer` folder has appeared with container configuration information inside a `Dockerfile` and `devcontainer.json` file.</span></span>  

    ![VS Code devcontainer 文件夹](../media/docker-extension4.png)

8. <span data-ttu-id="cb10c-189">若要确认你的项目仍连接到 WSL 和容器内，请打开 VS Code 集成终端 (Ctrl + Shift + ~) 。</span><span class="sxs-lookup"><span data-stu-id="cb10c-189">To confirm that your project is still connected to both WSL and within a container, open the VS Code integrated terminal (Ctrl + Shift + ~).</span></span> <span data-ttu-id="cb10c-190">通过输入：和 Python 版本来检查操作系统， `uname` 并提供： `python3 --version` 。</span><span class="sxs-lookup"><span data-stu-id="cb10c-190">Check the operating system by entering: `uname` and the Python version with: `python3 --version`.</span></span> <span data-ttu-id="cb10c-191">你可以看到，uname 恢复为 "Linux"，因此你仍连接到 WSL 2 引擎，Python 版本号将基于与 WSL 分发上安装的 Python 版本不同的容器配置。</span><span class="sxs-lookup"><span data-stu-id="cb10c-191">You can see that the uname came back as "Linux", so you are still connected to the WSL 2 engine, and Python version number will be based on the container config that may differ from the Python version installed on your WSL distribution.</span></span>

9. <span data-ttu-id="cb10c-192">若要使用 Visual Studio Code 在容器中运行和调试应用程序，请先打开 " **运行** " 菜单 (Ctrl + Shift + D，或在最左侧的菜单栏) 上选择选项卡。</span><span class="sxs-lookup"><span data-stu-id="cb10c-192">To run and debug your app inside of the container using Visual Studio Code, first open the **Run** menu (Ctrl+Shift+D or select the tab on the far left menu bar).</span></span> <span data-ttu-id="cb10c-193">然后选择 " **运行" 和 "调试** " 以选择 "调试" 配置，并选择在我的示例中最佳地套件你的项目 (的配置，这将是 "Django" ) 。</span><span class="sxs-lookup"><span data-stu-id="cb10c-193">Then select **Run and Debug** to select a debug configuration and choose the configuration that best suites your project (in my example, this will be "Django").</span></span> <span data-ttu-id="cb10c-194">这会 `launch.json` 在项目的文件夹中创建一个文件 `.vscode` ，其中包含有关如何运行你的应用程序的说明。</span><span class="sxs-lookup"><span data-stu-id="cb10c-194">This will create a `launch.json` file in the `.vscode` folder of your project with instructions on how to run your app.</span></span>

    ![VS Code 运行调试配置](../media/vscode-run-config.png)

10. <span data-ttu-id="cb10c-196">在 VS Code 中，选择 "**运行**" "  >  **开始调试**" (或只需按**F5**键) 。</span><span class="sxs-lookup"><span data-stu-id="cb10c-196">From inside VS Code, select **Run** > **Start debugging** (or just press the **F5** key).</span></span> <span data-ttu-id="cb10c-197">这会在 VS Code 中打开终端，你应看到如下所示的结果： " http://127.0.0.1:8000/ 使用 CONTROL C 退出服务器"。</span><span class="sxs-lookup"><span data-stu-id="cb10c-197">This will open a terminal inside VS Code and you should see a result saying something like: "Starting development server at http://127.0.0.1:8000/ Quit the server with CONTROL-C."</span></span> <span data-ttu-id="cb10c-198">按住 Ctrl 键并选择显示的用于在默认 web 浏览器中打开应用程序的地址，并查看在它的容器中运行的项目。</span><span class="sxs-lookup"><span data-stu-id="cb10c-198">Hold down the Control key and select the address displayed to open your app in your default web browser and see your project running inside of it's container.</span></span>

    ![运行 docker 容器 VS Code](../media/vscode-running-in-container.png)

<span data-ttu-id="cb10c-200">现在，你已成功配置了使用 Docker Desktop 的远程开发容器，该容器由 WSL 2 后端提供支持，你可以使用 VS Code 进行编码、生成、运行、部署或调试！</span><span class="sxs-lookup"><span data-stu-id="cb10c-200">You have now successfully configured a remote development container using Docker Desktop, powered by the WSL 2 backend, that you can code in, build, run, deploy, or debug using VS Code!</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="cb10c-201">疑难解答</span><span class="sxs-lookup"><span data-stu-id="cb10c-201">Troubleshooting</span></span>

### <a name="wsl-docker-context-deprecated"></a><span data-ttu-id="cb10c-202">已弃用 WSL docker 上下文</span><span class="sxs-lookup"><span data-stu-id="cb10c-202">WSL docker context deprecated</span></span>

<span data-ttu-id="cb10c-203">如果你使用的是 WSL 的早期技术预览版，则可能有一个名为 "WSL" 的 Docker 上下文，该上下文现在已弃用且不再使用。</span><span class="sxs-lookup"><span data-stu-id="cb10c-203">If you were using an  early Tech Preview of Docker for WSL, you may have a Docker context called "wsl" that is now deprecated and no longer used.</span></span> <span data-ttu-id="cb10c-204">可以检查命令： `docker context ls` 。</span><span class="sxs-lookup"><span data-stu-id="cb10c-204">You can check with the command: `docker context ls`.</span></span> <span data-ttu-id="cb10c-205">你可以使用以下命令删除此 "wsl" 上下文，以避免错误： `docker context rm wsl` 你想要使用 Windows 和 WSL2 的默认上下文。</span><span class="sxs-lookup"><span data-stu-id="cb10c-205">You can remove this "wsl" context to avoid errors with the command: `docker context rm wsl` as you want to use the default context for both Windows and WSL2.</span></span>

<span data-ttu-id="cb10c-206">使用此不推荐使用的 wsl 上下文可能遇到的错误包括： `docker wsl open //./pipe/docker_wsl: The system cannot find the file specified.` 或 `error during connect: Get http://%2F%2F.%2Fpipe%2Fdocker_wsl/v1.40/images/json?all=1: open //./pipe/docker_wsl: The system cannot find the file specified.`</span><span class="sxs-lookup"><span data-stu-id="cb10c-206">Possible errors you might encounter with this deprecated wsl context include: `docker wsl open //./pipe/docker_wsl: The system cannot find the file specified.` or `error during connect: Get http://%2F%2F.%2Fpipe%2Fdocker_wsl/v1.40/images/json?all=1: open //./pipe/docker_wsl: The system cannot find the file specified.`</span></span>

<span data-ttu-id="cb10c-207">有关此问题的详细信息，请参阅 [windows 10 上的如何在适用于 Linux (WSL2) 的 Windows 系统中设置 Docker](https://www.hanselman.com/blog/HowToSetUpDockerWithinWindowsSystemForLinuxWSL2OnWindows10.aspx)。</span><span class="sxs-lookup"><span data-stu-id="cb10c-207">For more on this issue, see [How to set up Docker within Windows System for Linux (WSL2) on Windows 10](https://www.hanselman.com/blog/HowToSetUpDockerWithinWindowsSystemForLinuxWSL2OnWindows10.aspx).</span></span>

### <a name="trouble-finding-docker-image-storage-folder"></a><span data-ttu-id="cb10c-208">查找 docker 映像存储文件夹时遇到问题</span><span class="sxs-lookup"><span data-stu-id="cb10c-208">Trouble finding docker image storage folder</span></span>

<span data-ttu-id="cb10c-209">Docker 创建了两个用于存储数据的发行版文件夹：</span><span class="sxs-lookup"><span data-stu-id="cb10c-209">Docker creates two distro folders to store data:</span></span>
- <span data-ttu-id="cb10c-210">\\wsl $ \docker-desktop</span><span class="sxs-lookup"><span data-stu-id="cb10c-210">\\wsl$\docker-desktop</span></span>
- <span data-ttu-id="cb10c-211">\\wsl $ \docker-desktop-data</span><span class="sxs-lookup"><span data-stu-id="cb10c-211">\\wsl$\docker-desktop-data</span></span>

<span data-ttu-id="cb10c-212">可以通过打开 WSL Linux 分发版并输入： `explorer.exe .` 在 Windows 文件资源管理器中查看文件夹来找到这些文件夹。</span><span class="sxs-lookup"><span data-stu-id="cb10c-212">You can find these folders by opening your WSL Linux distribution and entering: `explorer.exe .` to view the folder in Windows File Explorer.</span></span> <span data-ttu-id="cb10c-213">输入： `\\wsl\<distro name>\mnt\wsl` `<distro name>` 将替换为分发 (的名称。Ubuntu-20.04) 查看这些文件夹。</span><span class="sxs-lookup"><span data-stu-id="cb10c-213">Enter: `\\wsl\<distro name>\mnt\wsl` replacing `<distro name>` with the name of your distribution (ie. Ubuntu-20.04) to see these folders.</span></span>

<span data-ttu-id="cb10c-214">有关在 WSL 中查找 docker 存储位置的详细信息，请参阅 WSL 存储库中 [的此问题](https://github.com/microsoft/WSL/issues/4176) 或此 [StackOverlow post](https://stackoverflow.com/questions/62380124/where-docker-image-is-stored-with-docker-desktop-for-windows)。</span><span class="sxs-lookup"><span data-stu-id="cb10c-214">Find more on locating docker storage locations in WSL, see this [issue from the WSL repo](https://github.com/microsoft/WSL/issues/4176) or this [StackOverlow post](https://stackoverflow.com/questions/62380124/where-docker-image-is-stored-with-docker-desktop-for-windows).</span></span>

<span data-ttu-id="cb10c-215">有关 WSL 中的常规故障排除问题的更多帮助，请参阅 [疑难解答](../troubleshooting.md) 文档。</span><span class="sxs-lookup"><span data-stu-id="cb10c-215">For more help with general troubleshooting issues in WSL, see the [Troubleshooting](../troubleshooting.md) doc.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="cb10c-216">其他资源</span><span class="sxs-lookup"><span data-stu-id="cb10c-216">Additional resources</span></span>

- [<span data-ttu-id="cb10c-217">Docker 文档：用于 WSL 2 的 Docker 桌面的最佳实践</span><span class="sxs-lookup"><span data-stu-id="cb10c-217">Docker docs: Best practices for Docker Desktop with WSL 2</span></span>](https://docs.docker.com/docker-for-windows/wsl/#best-practices)
- [<span data-ttu-id="cb10c-218">适用于 Windows 的 Docker 桌面的反馈：文件问题</span><span class="sxs-lookup"><span data-stu-id="cb10c-218">Feedback for Docker Desktop for Windows: File an issue</span></span>](https://github.com/docker/for-win/issues)
- [<span data-ttu-id="cb10c-219">VS Code 博客：用于选择开发环境的准则</span><span class="sxs-lookup"><span data-stu-id="cb10c-219">VS Code Blog: Guidelines for choosing a development environment</span></span>](https://code.visualstudio.com/docs/containers/choosing-dev-environment#_guidelines-for-choosing-a-development-environment)
- [<span data-ttu-id="cb10c-220">VS Code 博客：在 WSL 2 中使用 Docker</span><span class="sxs-lookup"><span data-stu-id="cb10c-220">VS Code Blog: Using Docker in WSL 2</span></span>](https://code.visualstudio.com/blogs/2020/03/02/docker-in-wsl2)
- [<span data-ttu-id="cb10c-221">VS Code 博客：使用 WSL 2 中的远程容器</span><span class="sxs-lookup"><span data-stu-id="cb10c-221">VS Code Blog: Using Remote Containers in WSL 2</span></span>](https://code.visualstudio.com/blogs/2020/07/01/containers-wsl)
- [<span data-ttu-id="cb10c-222">Hanselminutes 播客：为具有 Simon Ferquel 的开发人员创建 Docker 可爱</span><span class="sxs-lookup"><span data-stu-id="cb10c-222">Hanselminutes Podcast: Making Docker lovely for Developers with Simon Ferquel</span></span>](https://hanselminutes.com/736/making-docker-lovely-for-developers-with-simon-ferquel)